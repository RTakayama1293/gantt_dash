# EEZO 2026 タスクダッシュボード 操作マニュアル

## 目次

1. [はじめに](#はじめに)
2. [起動方法](#起動方法)
3. [画面構成](#画面構成)
4. [フィルター機能](#フィルター機能)
5. [表示設定](#表示設定)
6. [並べ替え機能](#並べ替え機能)
7. [ガントチャートの操作](#ガントチャートの操作)
8. [Excel出力](#excel出力)
9. [よくある質問](#よくある質問)

---

## はじめに

EEZO 2026 タスクダッシュボードは、北海道食材EC「EEZO」の年間プロジェクト（240タスク）を可視化するためのインタラクティブなガントチャートツールです。

### 主な特徴

- 四半期・担当者・カテゴリでのフィルタリング
- 日付範囲の絞り込み
- 柔軟な並べ替え機能（昇順/降順、カスタム順序）
- グループ化・ソート機能
- マイルストーンの強調表示
- **Excelガントチャート形式でのエクスポート**

---

## 起動方法

### 1. 必要な環境

- Python 3.10以上
- 必要なパッケージ（pandas, dash, plotly, openpyxl等）

### 2. 初回セットアップ

```bash
# プロジェクトディレクトリに移動
cd gantt_dash

# 依存関係のインストール
pip install -r requirements.txt
```

### 3. アプリケーションの起動

```bash
python src/app.py
```

### 4. ブラウザでアクセス

起動後、以下のURLをブラウザで開きます：

```
http://127.0.0.1:8050
```

---

## 画面構成

アプリケーションは以下の4つのエリアで構成されています：

```
┌─────────────────────────────────────────────────────┐
│  ヘッダー                              [Excel出力]  │
├─────────────────────────────────────────────────────┤
│  フィルター・表示設定エリア                          │
│  ・四半期 / 担当者 / カテゴリ フィルター             │
│  ・期間粒度 / グループ化 / 色分け / 今日線          │
│  ・ソート項目 / 昇順降順 / カテゴリ並び順 / 担当者並び順 │
│  ・日付範囲スライダー                               │
├─────────────────────────────────────────────────────┤
│  サマリーエリア                                     │
│  タスク数 | 期間 | 担当者別 | カテゴリ別             │
├─────────────────────────────────────────────────────┤
│                                                     │
│              ガントチャート表示エリア                │
│                                                     │
└─────────────────────────────────────────────────────┘
```

---

## フィルター機能

### 四半期フィルター

| 項目 | 説明 |
|------|------|
| Q1 | 1月〜3月（Shopify移行期） |
| Q2 | 4月〜6月（ローンチ後改善期） |
| Q3 | 7月〜9月（O2O・イベント連動期） |
| Q4 | 10月〜12月（年末商戦・AI機能期） |

**操作方法：**
- ドロップダウンをクリックして選択
- 複数選択可能
- 「×」で個別解除、全て消すと全期間非表示

### 担当者フィルター

| 担当者 | 主な担当領域 |
|--------|-------------|
| 松永 | プラットフォーム実装、UX動線 |
| 高山 | 商品コンテンツ、集客販促、データ活用 |

**操作方法：**
- 複数選択可能
- 両方選択で全タスク表示

### カテゴリフィルター

| カテゴリ | 色 | 説明 |
|----------|-----|------|
| プラットフォーム実装 | 青 | Shopify移行・技術基盤 |
| UX動線 | 紫 | GA4/GTM計測・ユーザー行動分析 |
| 商品コンテンツ | 赤 | 商品選定・説明文・写真 |
| 集客販促 | オレンジ | 広告・SNS・メルマガ |
| データ活用 | 緑 | 分析基盤・BI構築 |

**操作方法：**
- 複数選択可能
- 特定カテゴリのみ表示したい場合は他を解除

### 日付範囲スライダー

画面下部のスライダーで表示期間を絞り込めます。

**操作方法：**
1. 左端のハンドルをドラッグ → 開始日を調整
2. 右端のハンドルをドラッグ → 終了日を調整
3. 中央部分をドラッグ → 範囲を維持したまま移動

---

## 表示設定

### 期間粒度

X軸（横軸）の目盛り間隔を変更します。Excel出力時にも適用されます。

| 設定 | 目盛り間隔 | 推奨用途 |
|------|-----------|---------|
| 日 | 1日ごと | 短期間の詳細確認 |
| 週 | 7日ごと | 通常利用（デフォルト） |
| 月 | 1ヶ月ごと | 年間全体の俯瞰 |

### グループ化

タスクの縦方向の並び方を変更します。

| 設定 | 表示形式 | 説明 |
|------|---------|------|
| なし | タスク名のみ | シンプルな一覧表示 |
| 担当者別 | 「担当者 \| タスク名」 | 担当者ごとにグループ化 |
| カテゴリ別 | 「カテゴリ \| タスク名」 | カテゴリごとにグループ化 |

### 色分け

バーの色の基準を変更します。Excel出力時にも適用されます。

| 設定 | 説明 |
|------|------|
| カテゴリ | 5色で業務分類を識別（デフォルト） |
| 担当者 | 2色で担当者を識別 |

### 今日線

現在日付を示す赤い縦線の表示/非表示を切り替えます。

- チェックあり：今日の位置に赤い破線を表示
- チェックなし：非表示

---

## 並べ替え機能

### ソート項目

タスクの並び順の基準を選択します。

| 設定 | 説明 |
|------|------|
| 開始日 | タスクの開始日を基準にソート |
| 担当者 | 担当者名を基準にソート（カスタム順序対応） |
| カテゴリ | カテゴリ名を基準にソート（カスタム順序対応） |

### 昇順/降順

ソートの方向を切り替えます。

| 設定 | 説明 |
|------|------|
| 昇順 ↑ | 小さい順（開始日なら早い順、担当者/カテゴリなら設定順） |
| 降順 ↓ | 大きい順（開始日なら遅い順、担当者/カテゴリなら逆順） |

### カテゴリ並び順

カテゴリでソートする際の並び順をカスタマイズできます。

**操作方法：**
1. ドロップダウンの項目を一度削除（×ボタン）
2. 希望の順序で再選択
3. 選択した順序がソート時の優先順位になります

**例：** 「データ活用」を最初に表示したい場合
1. 全項目を削除
2. 「データ活用」→「プラットフォーム実装」→...の順で選択

### 担当者並び順

担当者でソートする際の並び順をカスタマイズできます。

**デフォルト：** 松永 → 高山

**操作方法：**
- カテゴリ並び順と同様に、削除→再選択で順序変更

---

## ガントチャートの操作

### 基本操作

| 操作 | 方法 | 説明 |
|------|------|------|
| ズームイン | マウスホイール上 | 期間を拡大表示 |
| ズームアウト | マウスホイール下 | 期間を縮小表示 |
| パン（移動） | ドラッグ | 表示範囲を移動 |
| リセット | ダブルクリック | 元の表示に戻る |

### ツールバー

チャート右上に表示されるツールバーの機能：

| アイコン | 機能 |
|---------|------|
| 📷 カメラ | PNG画像としてダウンロード |
| 🔍+ | ズームイン |
| 🔍- | ズームアウト |
| ✋ パン | ドラッグで移動モード |
| 🏠 ホーム | 表示をリセット |

### ホバー情報（ツールチップ）

タスクバーにマウスを乗せると、以下の詳細情報が表示されます：

- タスク名
- 期間（開始日〜終了日、日数）
- 四半期・週番号
- 担当者
- カテゴリ
- 成果物/マイルストーン

### マイルストーン表示

★マークが付いた重要なマイルストーンは、タスクバーの終了位置に**金色の星マーカー**で強調表示されます。

---

## Excel出力

### 出力方法

1. 画面右上の「**Excel出力**」ボタンをクリック
2. ファイルが自動的にダウンロードされます

### ファイル名

```
eezo_gantt_YYYYMMDD.xlsx
```
（例：eezo_gantt_20260115.xlsx）

### 出力形式

**リスト形式ではなく、ガントチャート形式で出力されます。**

| 項目 | 説明 |
|------|------|
| 表頭（横軸） | 選択した期間粒度（日/週/月）に応じた日付列 |
| 表側（縦軸） | 現在の並べ替え順序でタスクを表示 |
| セルの色 | ダッシュボードの色分け設定に準拠 |

### シート構成

#### シート1: ガントチャート

| 列 | 内容 |
|----|------|
| No. | 連番 |
| 担当者 | 松永 / 高山 |
| カテゴリ | 5種類のいずれか |
| タスク | タスク名（★マイルストーンは★付き） |
| 日付列... | 期間に応じて色塗り |

**特徴：**
- ウィンドウ枠が固定されているため、スクロールしてもヘッダーとタスク名が常に表示
- タスク期間に該当するセルがカテゴリ/担当者の色で塗りつぶし
- マイルストーンタスクは「★」マークが付与

#### シート2: 凡例

- 色の凡例（カテゴリまたは担当者）
- サマリー情報
  - 総タスク数
  - 期間（開始〜終了）
  - マイルストーン数

### Excel出力の活用例

1. **印刷用**: 月粒度で出力し、A3横向きで印刷
2. **進捗管理**: 週粒度で出力し、完了セルに別色を手動追加
3. **報告資料**: フィルターで特定担当者のみ抽出して出力

---

## よくある質問

### Q: チャートが表示されない

**A:** 以下を確認してください：
1. フィルターが適切に設定されているか
2. 日付範囲スライダーが正しい範囲か
3. ブラウザを更新してみる

### Q: 特定の担当者のタスクだけ見たい

**A:**
1. 「担当者」フィルターで対象者のみ選択
2. 「グループ化」を「なし」に設定
3. 「色分け」を「カテゴリ」にすると業務内容も把握しやすい

### Q: Q2だけのタスクを確認したい

**A:**
1. 「四半期」フィルターで「Q2」のみ選択
2. 必要に応じて日付範囲スライダーで微調整

### Q: カテゴリの表示順を変えたい

**A:**
1. 「ソート項目」で「カテゴリ」を選択
2. 「カテゴリ並び順」ドロップダウンで項目を削除
3. 希望の順序で項目を再選択
4. 必要に応じて「昇順/降順」を切り替え

### Q: 開始日の遅い順（降順）で表示したい

**A:**
1. 「ソート項目」で「開始日」を選択
2. 「降順 ↓」を選択

### Q: Excelで週単位のガントチャートを出力したい

**A:**
1. 「期間粒度」で「週」を選択
2. 必要なフィルターを適用
3. 「Excel出力」ボタンをクリック

### Q: マイルストーンだけを確認したい

**A:**
現時点ではマイルストーンのみのフィルター機能はありません。
チャート上で金色の★マーカーを目視で確認するか、Excel出力後に「タスク」列で「★」を含む行をフィルタリングしてください。

### Q: 印刷したい

**A:**
1. Excel出力で月粒度のガントチャートを出力
2. Excelで印刷設定を調整（A3横向き推奨）
3. または、ツールバーのカメラアイコンで画像をダウンロード

### Q: データを更新したい

**A:**
`data/raw/eezo_2026_weekly_tasks.csv` を編集後、アプリを再起動してください。
※ 元データのバックアップを推奨します。

---

## サポート

問題が発生した場合は、以下を確認してください：

1. `requirements.txt` の依存関係がすべてインストールされているか
2. Python 3.10以上が使用されているか
3. ブラウザのキャッシュをクリアしてみる

---

*最終更新: 2025-12-30*
